(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{628:function(t,s,a){t.exports=a.p+"assets/img/漫反射.a3c4f73b.png"},629:function(t,s,a){t.exports=a.p+"assets/img/环境反射.0c721ab6.png"},630:function(t,s){t.exports="data:image/png;base64,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"},631:function(t,s,a){t.exports=a.p+"assets/img/环境光下的漫反射.ec073bef.png"},632:function(t,s,a){t.exports=a.p+"assets/img/点光源.9cd0106c.png"},633:function(t,s,a){t.exports=a.p+"assets/img/镜面高光.8e41b6d0.png"},634:function(t,s,a){t.exports=a.p+"assets/img/光线到眼睛.0dec6835.png"},635:function(t,s,a){t.exports=a.p+"assets/img/高光-太亮.114ace67.png"},636:function(t,s,a){t.exports=a.p+"assets/img/高光-设置颜色.53b6041f.png"},637:function(t,s,a){t.exports=a.p+"assets/img/高光.f7206e52.png"},638:function(t,s,a){t.exports=a.p+"assets/img/聚光灯-粗糙.932b6b62.png"},639:function(t,s,a){t.exports=a.p+"assets/img/聚光灯-平滑.d19d6de1.png"},931:function(t,s,a){"use strict";a.r(s);var n=a(41),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"_1-光源类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-光源类型"}},[t._v("#")]),t._v(" 1.光源类型")]),t._v(" "),s("p",[t._v("真实世界中的光主要有2种类型，"),s("strong",[t._v("平行光")]),t._v("和"),s("strong",[t._v("点光源光")]),t._v("：类似于电灯泡发出的光。\n同时我们还会用"),s("strong",[t._v("环境光")]),t._v("来模拟真实世界中的非直射光（也就是由光源发出后经过墙壁或者其他物体反射后的光）。三维图形学中会使用一些其他类型的光，比如"),s("strong",[t._v("聚光等光")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"_1-平行光"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-平行光"}},[t._v("#")]),t._v(" 1.平行光")]),t._v(" "),s("p",[t._v("光线平行，具有方向。可以用一个方向和颜色来定义。")]),t._v(" "),s("h3",{attrs:{id:"_2-点光源光"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-点光源光"}},[t._v("#")]),t._v(" 2.点光源光")]),t._v(" "),s("p",[t._v("点光源光是从一个点向周围的所有方向发出的光。定义点光源时我们需要指定点光源的位置和颜色。")]),t._v(" "),s("h3",{attrs:{id:"_3-环境光"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-环境光"}},[t._v("#")]),t._v(" 3.环境光")]),t._v(" "),s("p",[t._v("指那些经光源发出后，被墙壁等物体多次反射，然后照到物体表面上的光。环境光从各个角度照射物体，起强度都是一致的。环境光不用指定位置和方向，只需要指定颜色就行。")]),t._v(" "),s("h2",{attrs:{id:"_2-反射类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-反射类型"}},[t._v("#")]),t._v(" 2.反射类型")]),t._v(" "),s("p",[t._v("根据物体表面反射光线的方式，可以分为"),s("strong",[t._v("漫反射")]),t._v("和"),s("strong",[t._v("环境反射")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"_1-漫反射"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-漫反射"}},[t._v("#")]),t._v(" 1.漫反射")]),t._v(" "),s("p",[s("strong",[t._v("漫反射是针对平行光和点光源")]),t._v("而言的，漫反射的反射光在各个方向上都是均匀的。有些物体的表面是粗糙的，在这种情况下，反射光就会以不固定的角度反射出去。")]),t._v(" "),s("p",[t._v("反射光的颜色取决于"),s("strong",[t._v("入射光的颜色")]),t._v("、"),s("strong",[t._v("表面的基底色")]),t._v("、"),s("strong",[t._v("入射光")]),t._v("与表面法线形成的"),s("strong",[t._v("入射角")]),t._v("。入射角为入射光与表面的法线形成的夹角，用"),s("code",[t._v("𝜃")]),t._v(" 表示 ，漫反射光的颜色可以根据下面的公式计算得到。")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("漫反射光的颜色计算")])])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("物体漫反射光颜色 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 入射光颜色 "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("X")]),t._v(" 表面基底色 "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("X")]),t._v(" cos𝜃\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("img",{attrs:{width:"200",src:a(628)}}),t._v(" "),s("h3",{attrs:{id:"_2-环境反射"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-环境反射"}},[t._v("#")]),t._v(" 2.环境反射")]),t._v(" "),s("p",[s("strong",[t._v("环境反射是针对环境光")]),t._v("而言的。 反射光的方向可以认为就是"),s("strong",[t._v("入射光的反方向")]),t._v("。由于环境光照射物体的方式就是各方向均匀、强度相等的，所以反射光也是各向均匀的。")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("环境反射光")]),t._v("的颜色计算。")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("物体环境反射光颜色 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 入射光颜色 "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("X")]),t._v(" 表面基颜色\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("img",{attrs:{width:"200",src:a(629)}}),t._v(" "),s("ul",[s("li",[s("strong",[t._v("漫反射和环境反射")]),t._v(" 同时存在时物体的颜色计算")])]),t._v(" "),s("p",[t._v("当漫反射和环境反射同时存在时，将两者加起来，就会得到物体最终被观察到的颜色。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("物体表面的颜色 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 漫反射光颜色 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" 环境反射光颜色\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"_3-平行光下的漫反射"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-平行光下的漫反射"}},[t._v("#")]),t._v(" 3.平行光下的漫反射")]),t._v(" "),s("p",[t._v("上面的"),s("code",[t._v("cos𝜃")]),t._v("可以用两个矢量的点积来得到。下面的等式成立的条件是光线方向和法线方向向量必须都是单位向量。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("cos𝜃 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 光线方向 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" 法线方向 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("光线方向"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("法线方向"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("cos𝜃\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("所以上面上面的漫反射光的公式可以写成")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("物体漫反射光颜色 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 入射光颜色 "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("X")]),t._v(" 表面基底色 "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("X")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("光线方向 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" 法线方向"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("strong",[t._v("注意：")])]),t._v(" "),s("ul",[s("li",[t._v("光线方向矢量和表面法线矢量的长度必须时 "),s("code",[t._v("1")]),t._v("，否则反射光的颜色就会过暗或者过亮。将一个矢量的长度调整为1，同时保持方向不变的过程称之为"),s("strong",[t._v("归一化")]),t._v("。")]),t._v(" "),s("li",[s("strong",[t._v("光线方向")]),t._v("，实际上是"),s("strong",[t._v("入射方向的反方向")]),t._v("，是从入射点指向光源的方向。")])]),t._v(" "),s("p",[s("strong",[t._v("法线")]),t._v(": 垂直于物体表面的方向，称之为法线或者法向量。因为每个表面都有两个面，所以每个表面都具有两个法向量。")]),t._v(" "),s("p",[t._v("平行光下的漫反射的 "),s("strong",[t._v("顶点着色器中")]),t._v("的代码如下所示：")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("  attribute vec4 a_Position"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  attribute vec4 a_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n  attribute vec4 a_Normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Normal 法向量")]),t._v("\n  uniform mat4 u_MvpMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  uniform vec3 u_LightColor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Light color 光线颜色")]),t._v("\n  uniform vec3 u_LightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Light direction (in the world coordinate, normalized) 光线方向")]),t._v("\n  varying vec4 v_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    gl_Position "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_MvpMatrix "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a_Position "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Make the length of the normal 1.0")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 法向量归一化")]),t._v("\n    vec3 normal "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a_Normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xyz"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Dot product of the light direction and the orientation of a surface (the normal)")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算点积")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当角度大于90时，将点积赋值为0，表示光线是找到了背面，所以我们看到的物体是暗的。")]),t._v("\n    float nDotL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_LightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Calculate the color due to diffuse reflection")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算漫反射光的颜色")]),t._v("\n    vec3 diffuse "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_LightColor "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" nDotL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    v_Color "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vec4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("diffuse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br")])]),s("p",[t._v("平行光下的漫反射的 主要"),s("code",[t._v("js")]),t._v("代码如下所示")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" u_MvpMatrix "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUniformLocation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("program"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'u_MvpMatrix'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" u_LightColor "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUniformLocation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("program"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'u_LightColor'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ncomst u_LightDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUniformLocation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("program"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'u_LightDirection'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("u_MvpMatrix "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("u_LightColor "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("u_LightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Failed to get the storage location'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Set the light color (white)")]),t._v("\ngl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniform3f")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_LightColor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Set the light direction (in the world coordinate)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" lightDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vector3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Normalize")]),t._v("\ngl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniform3fv")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_LightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elements"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Calculate the view projection matrix")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" mvpMatrix "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Matrix4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Model view projection matrix")]),t._v("\nmvpMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setPerspective")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" canvas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("canvas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("height"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmvpMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lookAt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Pass the model view projection matrix to the variable u_MvpMatrix")]),t._v("\ngl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniformMatrix4fv")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_MvpMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mvpMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elements"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br")])]),s("p",[t._v("具体的 "),s("code",[t._v("demo")]),t._v("地址  "),s("a",{attrs:{href:"https://github.com/tangjie-93/WebGL/blob/main/%E8%B7%9F%E7%9D%80%E5%AE%98%E7%BD%91%E5%AD%A6WebGL%2BWebGL%E7%BC%96%E7%A8%8B%E6%8C%87%E5%8D%97/%E5%85%89%E7%85%A7/demo/%E5%B9%B3%E8%A1%8C%E5%85%89%E7%9A%84%E6%BC%AB%E5%8F%8D%E5%B0%84.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("平行光的漫反射"),s("OutboundLink")],1),t._v(" 。\n最终的绘制效果如下所示：\n"),s("img",{attrs:{width:"200",src:a(630)}}),t._v("\n从上面的图片中我们可以看到右侧表面是全黑的。这是因为我们没有考虑到环境光对物体的照射效果。所以我们还需要加上物体表面的环境反射光的颜色，才能得到物体表面最终的颜色。")]),t._v(" "),s("p",[t._v("所以我们需要对上面的代码做以下修改。")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("顶点着色器代码")])])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  uniform vec3 u_AmbientLight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Color of an ambient light 环境光")]),t._v("\n  varying vec4 v_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算环境光产生的反射光颜色")]),t._v("\n    vec3 ambient "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_AmbientLight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    v_Color "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vec4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("diffuse"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("ambient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("blockquote",[s("p",[s("code",[t._v("js")]),t._v("中也需要添加环境光的代码。")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" u_AmbientLight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUniformLocation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("program"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'u_AmbientLight'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Set the ambient light")]),t._v("\ngl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniform3f")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_AmbientLight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("最终的绘制结果如下所示\n"),s("img",{attrs:{src:a(631)}})]),t._v(" "),s("p",[s("code",[t._v("demo")]),t._v(" 地址  "),s("a",{attrs:{href:"https://github.com/tangjie-93/WebGL/blob/main/%E8%B7%9F%E7%9D%80%E5%AE%98%E7%BD%91%E5%AD%A6WebGL%2BWebGL%E7%BC%96%E7%A8%8B%E6%8C%87%E5%8D%97/%E5%85%89%E7%85%A7/demo/%E7%8E%AF%E5%A2%83%E5%85%89%E4%B8%8B%E7%9A%84%E6%BC%AB%E5%8F%8D%E5%B0%84.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("环境光下的漫反射"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"_3-运动物体的光照效果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-运动物体的光照效果"}},[t._v("#")]),t._v(" 3.运动物体的光照效果")]),t._v(" "),s("p",[t._v("物体旋转时，每个表面的法向量都会随之改变。所以我们需要在运动的过程中，需要不断计算更新后的法向量。这里我们会用到"),s("strong",[t._v("逆转置矩阵")]),t._v("，将变换之前的法向量乘以"),s("strong",[t._v("模型矩阵")]),t._v("的"),s("strong",[t._v("逆转置矩阵")]),t._v("就可以得到变换后的法向量。"),s("strong",[t._v("转置逆矩阵就是逆矩阵的转置")]),t._v("。")]),t._v(" "),s("p",[s("strong",[t._v("逆矩阵")]),t._v("：如果矩阵"),s("code",[t._v("M")]),t._v("的逆矩阵是 "),s("code",[t._v("R")]),t._v(",那么"),s("code",[t._v("M*R")]),t._v("或者"),s("code",[t._v("R*M")]),t._v("的结果都是单位矩阵。\n"),s("strong",[t._v("转置")]),t._v("：将矩阵的行列进行调换(看上去就像是沿着左上-右下对角线进行了翻转)。")]),t._v(" "),s("p",[t._v("所以求逆转置矩阵主要由以下两个步骤：")]),t._v(" "),s("ul",[s("li",[t._v("求原矩阵的逆矩阵")]),t._v(" "),s("li",[t._v("将上一步得到的逆矩阵进行转置。\n所以我们需要将上一步使用环境光的顶点着色器中的代码再进行以下修改。")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  uniform mat4 u_NormalMatrix\n  uniform vec3 u_AmbientLight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Color of an ambient light 环境光")]),t._v("\n  varying vec4 v_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算旋转后的反射光")]),t._v("\n    vec3 normal "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vec3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_NormalMatrix "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a_Normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算环境光产生的反射光颜色")]),t._v("\n    vec3 ambient "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_AmbientLight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    v_Color "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vec4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("diffuse"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("ambient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br")])]),s("p",[s("code",[t._v("js")]),t._v("中的代码需要做如下修改")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Calculate the matrix to transform the normal based on the model matrix")]),t._v("\nnormalMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setInverseOf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("modelMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nnormalMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("transpose")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Pass the transformation matrix for normals to u_NormalMatrix")]),t._v("\ngl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniformMatrix4fv")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_NormalMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" normalMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elements"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("具体"),s("code",[t._v("demo")]),t._v("地址 "),s("a",{attrs:{href:"https://github.com/tangjie-93/WebGL/blob/main/%E8%B7%9F%E7%9D%80%E5%AE%98%E7%BD%91%E5%AD%A6WebGL%2BWebGL%E7%BC%96%E7%A8%8B%E6%8C%87%E5%8D%97/%E5%85%89%E7%85%A7/demo/%E8%BF%90%E5%8A%A8%E7%89%A9%E4%BD%93%E7%9A%84%E9%A2%9C%E8%89%B2.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("运动物体的颜色"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"_4-点光源光的着色效果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-点光源光的着色效果"}},[t._v("#")]),t._v(" 4.点光源光的着色效果")]),t._v(" "),s("p",[t._v("在对点光源下的物体进行着色时，需要在每个入射点计算点光源在该处的方向。点光源"),s("strong",[t._v("光的方向")]),t._v("不是恒定不变的，需要"),s("strong",[t._v("根据每个顶点的位置逐一计算")]),t._v("。")]),t._v(" "),s("p",[t._v("顶点着色器中的代码跟上面平行光的代码有点不一样，在这里需要不断在"),s("strong",[t._v("世界坐标系中")]),t._v("计算顶点坐标"),s("strong",[t._v("光的方向")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\nuniform mat4 u_ModelMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\nuniform vec3 u_LightPosition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在世界坐标系下光源的位置")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算顶点的世界坐标")]),t._v("\nvec4 vertexPosition "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_ModelMatrix "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a_Position"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算光线方向并归一化")]),t._v("\nvec3 lightDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_LightPosition "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vec3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vertexPosition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("p",[t._v("最终的展示效果如下所示：")]),t._v(" "),s("img",{attrs:{width:"200",src:a(632)}}),t._v(" "),s("p",[t._v("具体的"),s("code",[t._v("demo")]),t._v("地址 "),s("a",{attrs:{href:"https://github.com/tangjie-93/WebGL/blob/main/%E8%B7%9F%E7%9D%80%E5%AE%98%E7%BD%91%E5%AD%A6WebGL%2BWebGL%E7%BC%96%E7%A8%8B%E6%8C%87%E5%8D%97/%E5%85%89%E7%85%A7/demo/%E7%82%B9%E5%85%89%E6%BA%90%E5%85%89.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("点光源光"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("仔细观察会发现立方体表面会有"),s("strong",[t._v("不自然的线条")]),t._v("。")]),t._v(" "),s("p",[t._v("这是因为在"),s("code",[t._v("WebGL")]),t._v("系统中会根据顶点的颜色，内插出表面上每个片元的颜色。\n但是实际上，点光源照射到一个表面上，所产生的效果(每个片元获得的颜色)与简单使用4个顶点颜色（也是有点光源产生）内插出的效果并不完全相同，所以为了效果更逼真，我们需要"),s("strong",[t._v("对表面的每一点计算光照效果")]),t._v("。\n下面是逐片元计算模型颜色的例子。\n"),s("strong",[t._v("顶点着色器中的代码")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("attribute vec4 a_Position"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  attribute vec4 a_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  attribute vec4 a_Normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  uniform mat4 u_MvpMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  uniform mat4 u_ModelMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Model matrix")]),t._v("\n  uniform mat4 u_NormalMatrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Transformation matrix of the normal")]),t._v("\n  varying vec4 v_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  varying vec3 v_Normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  varying vec3 v_Position"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    gl_Position "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_MvpMatrix "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a_Position"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Calculate the vertex position in the world coordinate")]),t._v("\n    v_Position "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vec3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_ModelMatrix "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a_Position"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    v_Normal "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vec3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_NormalMatrix "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a_Normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    v_Color "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" a_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("p",[s("strong",[t._v("片元着色器中的代码")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("precision mediump float"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  uniform vec3 u_LightColor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Light color")]),t._v("\n  uniform vec3 u_LightPosition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Position of the light source")]),t._v("\n  uniform vec3 u_AmbientLight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ambient light color")]),t._v("\n  varying vec3 v_Normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  varying vec3 v_Position"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  varying vec4 v_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Normalize the normal because it is interpolated and not 1.0 in length any more")]),t._v("\n    vec3 normal "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v_Normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Calculate the light direction and make its length 1.")]),t._v("\n    vec3 lightDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_LightPosition "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" v_Position"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The dot product of the light direction and the orientation of a surface (the normal)")]),t._v("\n    float nDotL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Calculate the final color from diffuse reflection and ambient reflection")]),t._v("\n    vec3 diffuse "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_LightColor "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" v_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" nDotL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    vec3 ambient "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_AmbientLight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" v_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    gl_FragColor "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vec4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("diffuse "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" ambient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" v_Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br")])]),s("p",[t._v("具体"),s("code",[t._v("demo")]),t._v("地址"),s("a",{attrs:{href:"https://github.com/tangjie-93/WebGL/blob/main/%E8%B7%9F%E7%9D%80%E5%AE%98%E7%BD%91%E5%AD%A6WebGL%2BWebGL%E7%BC%96%E7%A8%8B%E6%8C%87%E5%8D%97/%E5%85%89%E7%85%A7/demo/%E7%82%B9%E5%85%89%E6%BA%90%E9%80%90%E7%89%87%E5%85%83%E5%85%89%E7%85%A7.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("点光源逐片元光照效果"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"_5-三维点光源-高光效果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-三维点光源-高光效果"}},[t._v("#")]),t._v(" 5.三维点光源-高光效果")]),t._v(" "),s("p",[t._v("观察现实世界中的物体，如果物体表面恰好将光线反射到你眼前， 就会显得非常明亮，像镜子一样。我们可以通过计算光线是否反射到眼前来模拟这种情况。")]),t._v(" "),s("p",[s("strong",[t._v("测试方法")]),t._v("：如果入射角和反射角恰好与眼睛和和光源的夹角相同，那么光线就会反射到眼前。")]),t._v(" "),s("img",{attrs:{width:"300",src:a(633)}}),t._v(" "),s("p",[s("strong",[t._v("计算方法")]),t._v("：根据物体表面到光源的方向，加上物体表面到视点/眼睛/相机的方向，再除以 "),s("code",[t._v("2")]),t._v(" 得到 "),s("code",[t._v("halfVector")]),t._v(" 向量， 将这个向量和法向量比较，如果方向一致，那么光线就会被反射到眼前。")]),t._v(" "),s("img",{attrs:{width:"300",src:a(634)}}),t._v(" "),s("p",[t._v("在着色器中中的代码表示如下所示：")]),t._v(" "),s("ul",[s("li",[t._v("顶点着色器")])]),t._v(" "),s("p",[t._v("在点元着色器中计算 "),s("code",[t._v("计算表面到光源的方向")]),t._v(" 和 "),s("code",[t._v("计算表面到相机的方向")]),t._v(",并将之传入到片元着色器。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("attribute vec4 a_position"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nattribute vec3 a_normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \nuniform vec3 u_lightWorldPosition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nuniform vec3 u_viewWorldPosition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \nuniform mat4 u_world"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nuniform mat4 u_worldViewProjection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nuniform mat4 u_worldInverseTranspose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \nvarying vec3 v_normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \nvarying vec3 v_surfaceToLight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nvarying vec3 v_surfaceToView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将位置和矩阵相乘")]),t._v("\n  gl_Position "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_worldViewProjection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a_position"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 重定向法向量并传递到片段着色器")]),t._v("\n  v_normal "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mat3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_worldInverseTranspose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a_normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算表面的世界坐标")]),t._v("\n  vec3 surfaceWorldPosition "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_world "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a_position"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xyz"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算表面到光源的方向")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 然后传递到片段着色器")]),t._v("\n  v_surfaceToLight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_lightWorldPosition "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" surfaceWorldPosition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算表面到相机的方向")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 然后传递到片段着色器")]),t._v("\n  v_surfaceToView "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_viewWorldPosition "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" surfaceWorldPosition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br")])]),s("ul",[s("li",[t._v("片元着色器")])]),t._v(" "),s("p",[t._v("在片元着色器中计算表面到光源和相机之间的 "),s("code",[t._v("halfVector")]),t._v("， 将它和法向量相乘，查看光线是否直接反射到眼前")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从顶点着色器中传入的值")]),t._v("\nvarying vec3 v_normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nvarying vec3 v_surfaceToLight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nvarying vec3 v_surfaceToView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \nuniform vec4 u_color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 由于 v_normal 是可变量，所以经过插值后不再是单位向量，")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 单位化后会成为单位向量")]),t._v("\n  vec3 normal "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v_normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  vec3 surfaceToLightDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v_surfaceToLight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  vec3 surfaceToViewDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v_surfaceToView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  vec3 halfVector "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("surfaceToLightDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" surfaceToViewDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  float light "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" surfaceToLightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  float specular "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" halfVector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  gl_FragColor "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 只将颜色部分（不包含 alpha） 和光照相乘")]),t._v("\n  gl_FragColor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*=")]),t._v(" light"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 直接加上高光")]),t._v("\n  gl_FragColor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" specular"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br")])]),s("p",[t._v("在"),s("code",[t._v("js")]),t._v("代码中，我们只需要设置"),s("code",[t._v("u_lightWorldPosition")]),t._v("和"),s("code",[t._v("u_viewWorldPosition")]),t._v("即可")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" lightWorldPositionLocation "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n    gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUniformLocation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("program"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u_lightWorldPosition"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" viewWorldPositionLocation "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n    gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUniformLocation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("program"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u_viewWorldPosition"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算相机矩阵")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" camera "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("150")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" target "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" up "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cameraMatrix "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("makeLookAt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("camera"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" up"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置光源位置")]),t._v("\ngl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniform3fv")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lightWorldPositionLocation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置相机位置")]),t._v("\ngl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniform3fv")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("viewWorldPositionLocation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" camera"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("p",[t._v("但是上面计算得到的高光效果并不是我们想要的，太亮了。")]),t._v(" "),s("img",{attrs:{width:"300",src:a(635)}}),t._v(" "),s("p",[t._v("为了解决太亮的问题，我们可以将点乘结果("),s("code",[t._v("dot(normal, halfVector)")]),t._v(")进行求幂运算来解决太亮的问题， 它会把高光从线性变换变成指数变换。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("specular "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" halfVector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" u_shininess"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("为了避免"),s("code",[t._v("specular = pow(dot(normal, halfVector), u_shininess)")]),t._v("得到的结果是赋值，所以我们只将点乘结果(法线方向和表面到光线的方向的点乘)为正("),s("code",[t._v("dot(normal, surfaceToLightDirection)>0.0")]),t._v(")的部分进行计算，其他部分设置为 "),s("code",[t._v("0.0")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("uniform vec4 u_color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nuniform float u_shininess"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mian")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  float light "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" surfaceToLightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  float specular "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("light "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    specular "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" halfVector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" u_shininess"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("p",[t._v("在"),s("code",[t._v("js")]),t._v("中设置"),s("code",[t._v("u_shininess")]),t._v("的值，用于调节亮度。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" shininessLocation "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUniformLocation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("program"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u_shininess"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置亮度")]),t._v("\ngl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniform1f")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("shininessLocation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" shininess"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("p",[t._v("如果你还想设置光照颜色和高光颜色的化可以进行如下设置")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("uniform vec4 u_color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nuniform float u_shininess"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nuniform vec3 u_lightColor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nuniform vec3 u_specularColor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 只将颜色部分（不包含 alpha） 和光照相乘")]),t._v("\n  gl_FragColor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*=")]),t._v(" light "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" u_lightColor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 直接和高光相加")]),t._v("\n  gl_FragColor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" specular "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" u_specularColor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("p",[t._v("在"),s("code",[t._v("js")]),t._v("中设置"),s("code",[t._v("u_lightColor")]),t._v("和"),s("code",[t._v("u_specularColor")]),t._v("的值")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" lightColorLocation "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n    gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUniformLocation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("program"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u_lightColor"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" specularColorLocation "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n    gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUniformLocation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("program"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u_specularColor"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置光照颜色")]),t._v("\ngl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniform3fv")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lightColorLocation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" m4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 绿光")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置高光颜色")]),t._v("\ngl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniform3fv")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("specularColorLocation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" m4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 红光")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("p",[t._v("下面是视觉效果")]),t._v(" "),s("img",{attrs:{width:"300",src:a(636)}}),t._v(" "),s("p",[s("code",[t._v("demo")]),t._v("地址 "),s("a",{attrs:{href:"https://github.com/tangjie-93/WebGL/blob/main/fundmantalExamples/%E5%85%89%E7%85%A7/%E4%B8%89%E7%BB%B4%E7%82%B9%E5%85%89%E6%BA%90-%E9%AB%98%E5%85%89.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("镜面高光效果"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"_6-聚光灯的着色效果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-聚光灯的着色效果"}},[t._v("#")]),t._v(" 6.聚光灯的着色效果")]),t._v(" "),s("h4",{attrs:{id:"_1-聚光灯的原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-聚光灯的原理"}},[t._v("#")]),t._v(" 1.聚光灯的原理")]),t._v(" "),s("p",[t._v("把点光源想象成一个点，光线从那个点照向所有方向。 实现聚光灯只需要"),s("strong",[t._v("以那个点为起点选择一个方向，作为聚光灯的方向")]),t._v("， 然后将其他光线方向与所选方向点乘，然后随意选择一个限定范围， 然后判断光线是否在限定范围内，如果不在就不照亮。"),s("br")]),t._v(" "),s("p",[s("img",{attrs:{width:"300",src:a(637)}}),s("br")]),t._v(" "),s("p",[t._v("在上方的图示中我们可以看到光线照向所有的方向，并且将每个方向的点乘结果显示在上面。 然后指定一个"),s("code",[t._v("方向")]),t._v("表示聚光灯的方向，选择一个限定（上方以度为单位）。计算"),s("code",[t._v("dot(surfaceToLight, -lightDirection)")]),t._v("的点乘结果。如果点乘结果大于这个限定，就照亮，否则不照亮。计算公式如下：")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("dotFromDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("surfaceToLight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("lightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dotFromDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" limitInDotSpace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用光照")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h4",{attrs:{id:"_2-代码实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-代码实现"}},[t._v("#")]),t._v(" 2.代码实现")]),t._v(" "),s("p",[t._v("计算聚光灯效果的代码我们只需要在上面计算高光效果上的片元着色器代码做出如下修改就行。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v(" \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从顶点着色器传入的值")]),t._v("\nvarying vec3 v_normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nvarying vec3 v_surfaceToLight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nvarying vec3 v_surfaceToView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \nuniform vec4 u_color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nuniform float u_shininess"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nuniform vec3 u_lightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 聚光灯的方向")]),t._v("\nuniform float u_limit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在点乘空间中")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 因为 v_normal 是可变量，被插值过")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 所以不是单位向量，单位可以让它成为再次成为单位向量")]),t._v("\n  vec3 normal "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v_normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  vec3 surfaceToLightDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v_surfaceToLight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  vec3 surfaceToViewDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v_surfaceToView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  vec3 halfVector "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("surfaceToLightDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" surfaceToViewDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  float light "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  float specular "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  float dotFromDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("surfaceToLightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                               "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("u_lightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dotFromDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" u_limit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    light "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" surfaceToLightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("light "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      specular "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" halfVector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" u_shininess"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果光线在聚光灯范围内 inLight 就为 1，否则为 0。 跟上面计算specular等价")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//float inLight = step(u_limit, dotFromDirection);")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//float light = inLight * dot(normal, surfaceToLightDirection);")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//float specular = inLight * pow(dot(normal, halfVector), u_shininess);")]),t._v("\n \n  gl_FragColor "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 只将颜色部分（不包含 alpha） 和光照相乘")]),t._v("\n  gl_FragColor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*=")]),t._v(" light"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 直接加上高光")]),t._v("\n  gl_FragColor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" specular"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br")])]),s("p",[t._v("在"),s("code",[t._v("js")]),t._v("中设置聚光灯的方向和限定")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" lightDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" limit "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("degToRad")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" lightDirectionLocation "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUniformLocation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("program"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u_lightDirection"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" limitLocation "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUniformLocation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("program"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u_limit"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" lmat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" m4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lookAt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lightPosition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" up"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlmat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" m4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("multiply")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("m4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("xRotation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lightRotationX"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lmat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlmat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" m4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("multiply")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("m4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("yRotation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lightRotationY"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lmat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// get the zAxis from the matrix")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// negate it because lookAt looks down the -Z axis")]),t._v("\nlightDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("lmat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("lmat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("lmat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ngl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniform3fv")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lightDirectionLocation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ngl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniform1f")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("limitLocation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Math"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("limit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br")])]),s("p",[s("strong",[t._v("注意")]),t._v("：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("gl.uniform1f(limitLocation, Math.cos(limit));")]),t._v("这里设置的是点乘空间中的限定，而不是角度。")]),t._v(" "),s("li",[s("code",[t._v("lightDirection")]),t._v("光照方向随着模型的旋转也要改变，所以需要重新计算。")])]),t._v(" "),s("p",[t._v("此时得到的光照效果如下，非常粗糙和僵硬。只有在聚光灯范围内才有光照效果， 在外面就直接变黑，没有任何过渡。")]),t._v(" "),s("p",[s("img",{attrs:{width:"300",src:a(638)}}),s("br")]),t._v(" "),s("h4",{attrs:{id:"_3-平滑过渡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-平滑过渡"}},[t._v("#")]),t._v(" 3.平滑过渡")]),t._v(" "),s("p",[t._v("为了解决上面的问题，我们需要对光照进行平滑过渡。我们可以使用两个限定值代替原来的一个， 一个内部限定一个外部限定。如果在内部限定内就使用 "),s("code",[t._v("1.0")]),t._v("， 在外部限定外面就使用 "),s("code",[t._v("0.0")]),t._v("，在内部和外部限定之间就使用 "),s("code",[t._v("1.0")]),t._v(" 到 "),s("code",[t._v("0.0")]),t._v(" 之间的插值。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("uniform float u_innerLimit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在点乘空间中")]),t._v("\nuniform float u_outerLimit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在点乘空间中")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n \n  float dotFromDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("surfaceToLightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                               "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("u_lightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  float limitRange "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" u_innerLimit "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" u_outerLimit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算插值，将之前接近1的值变成0~1之间的值")]),t._v("\n  float inLight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("clamp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dotFromDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" u_outerLimit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" limitRange"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  float light "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" inLight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" surfaceToLightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  float specular "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" inLight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" halfVector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" u_shininess"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br")])]),s("p",[t._v("上面的代码中我们使用了"),s("code",[t._v("clamp")]),t._v("函数，它可以将值限制在指定范围内。我们可以使用"),s("code",[t._v("smoothstep")]),t._v("对上面的"),s("code",[t._v("inLight")]),t._v("的求取进行以下简化。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("  float dotFromDirection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("surfaceToLightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                               "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("u_lightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  float inLight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("smoothstep")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("u_outerLimit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" u_innerLimit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dotFromDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  float light "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" inLight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" surfaceToLightDirection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  float specular "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" inLight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" halfVector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" u_shininess"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[s("code",[t._v("smoothstep")]),t._v(" 和 "),s("code",[t._v("step")]),t._v(" 相似返回一个 "),s("code",[t._v("0")]),t._v(" 到 "),s("code",[t._v("1")]),t._v(" 之间的值，但是它获取最大和最小边界值，返回该值在边界范围映射到 "),s("code",[t._v("0")]),t._v(" 到 "),s("code",[t._v("1")]),t._v(" 之间的插值。")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("smoothstep")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lowerBound"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" upperBound"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("最终的聚光灯效果如下所示")]),t._v(" "),s("p",[s("img",{attrs:{width:"300",src:a(639)}}),s("br")]),t._v(" "),s("p",[t._v("完整"),s("code",[t._v("demo")]),t._v("地址 "),s("a",{attrs:{href:"https://github.com/tangjie-93/WebGL/blob/main/fundmantalExamples/%E5%85%89%E7%85%A7/%E4%B8%89%E7%BB%B4%E8%81%9A%E5%85%89%E7%81%AF.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("聚光灯"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("strong",[t._v("参考文档")]),s("br"),t._v(" "),s("a",{attrs:{href:"https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-3d-lighting-point.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("WebGL 三维点光源"),s("OutboundLink")],1),s("br"),t._v(" "),s("a",{attrs:{href:"https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-3d-lighting-directional.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("WebGL 三维方向光源"),s("OutboundLink")],1),s("br"),t._v(" "),s("a",{attrs:{href:"https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-3d-lighting-spot.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("WebGL 三维聚光灯"),s("OutboundLink")],1),s("br"),t._v(" "),s("Valine")],1)])}),[],!1,null,null,null);s.default=r.exports}}]);